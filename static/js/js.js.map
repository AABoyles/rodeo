{"version":3,"sources":["window.guid.js","window.ipc.js","window.store.js","console.js","execute.js","file-nav.js","focus.js","helpers.js","install-package.js","main.js","menu.js","plots.js","preferences.js","search.js","session.js","templates.js","upload.js","editor/actions.js","editor/add.js","editor/new.js","events/desktop.js","shortcuts/display.js","windows/about.js","windows/display-variable.js","windows/markdown.js","windows/sizing.js","windows/startup-error.js"],"names":[],"mappings":"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","file":"js.js","sourcesContent":["'use strict';\n\n/**\n * Generates unique ids\n */\nconst guid = window.guid = (function () {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  return function () {\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n      s4() + '-' + s4() + s4() + s4();\n  };\n}());\n","'use strict';\n\n/**\n * Wrapper around ipcRenderer so we can wrap it later with something else\n * @type {{send: function, on: function}}\n */\nconst ipc = window.ipc = (function () {\n  var cid = (function () { let i = 0; return function () { return i++; }; }()),\n    ipcRender = require('electron').ipcRenderer;\n\n  function toArgs(obj) {\n    return Array.prototype.slice.call(obj, 0);\n  }\n\n  function on(emitter) {\n    return function (eventName, eventFn) {\n      try {\n        emitter.on(eventName, function () {\n          let eventResult,\n            eventArgs = toArgs(arguments);\n\n          eventResult = eventFn.apply(null, eventArgs);\n          console.log('ipc event trigger completed', eventName, eventResult);\n          return eventResult;\n        });\n        console.log('ipc event registered', eventName, eventFn.name);\n        return emitter;\n      } catch (ex) {\n        console.error('ipc event error', eventName, ex);\n      }\n    };\n  }\n\n  function send(emitter) {\n    return function () {\n      let eventId = cid().toString(),\n        args = toArgs(arguments),\n        eventName = args[0];\n\n      return new Promise(function (resolve, reject) {\n        let response,\n          eventReplyName = eventName + '_reply';\n\n        console.log('ipc sending', [eventName, eventId].concat(args.slice(1)));\n        emitter.send.apply(emitter, [eventName, eventId].concat(args.slice(1)));\n        response = function (event, id) {\n          let result;\n          if (id === eventId) {\n            ipcRender.removeListener(eventReplyName, response);\n            result = toArgs(arguments).slice(2);\n            if (result[0]) {\n              reject(new Error(result[0].message));\n            } else {\n              resolve(result[1]);\n            }\n          } else {\n            console.log(eventName, eventId, 'passed on', arguments);\n          }\n        };\n        console.log('ipc waiting for ', eventName, eventId, 'on', eventReplyName);\n        ipcRender.on(eventReplyName, response);\n      });\n    };\n  }\n\n  return {\n    send: send(ipcRender),\n    on: on(ipcRender)\n  };\n}());","'use strict';\n\nconst store = window.store = (function () {\n  function get(key) {\n    var result = window.localStorage.getItem(key);\n\n    if (result) {\n      try {\n        result = JSON.parse(result);\n      } catch (ex) {\n        // we're okay with this\n      }\n    }\n    return result;\n  }\n\n  function set(key, value) {\n    if (typeof value === 'object') {\n      value = JSON.stringify(value);\n    }\n    window.localStorage.setItem(key, value);\n  }\n\n  return {\n    get: get,\n    set: set\n  };\n}());","// TODO: just get this from IPython stderr\nvar msg = \"IPython -- An enhanced Interactive Python.\\n\"\nmsg += \"?         -> Introduction and overview of IPython's features.\\n\"\nmsg += \"%quickref -> Quick reference.\\n\"\nmsg += \"help      -> Python's own help system.\\n\"\nmsg += \"object?   -> Details about 'object', use 'object??' for extra details.\\n\"\nvar jqconsole = $('#console').jqconsole(msg, '>>> ');\nfunction startPrompt() {\n  // Start the prompt with history enabled.\n  jqconsole.Prompt(true, function (input) {\n    sendCommand(input);\n    // Restart the prompt.\n    startPrompt();\n  });\n}\n// 4 spaces for python\njqconsole.SetIndentWidth(4);\n\n// ctrl + l to clear\njqconsole.RegisterShortcut('l', function () {\n  jqconsole.Clear();\n});\n\n// ctrl + a to skip to beginning of line\njqconsole.RegisterShortcut('a', function () {\n  jqconsole.MoveToStart();\n});\n\n// ctrl + e to skip to end of line\njqconsole.RegisterShortcut('e', function () {\n  jqconsole.MoveToEnd();\n});\n\n// ctrl + c to cancel input\njqconsole.RegisterShortcut('c', function () {\n  if (!$(\"#btn-interrupt\").hasClass(\"hide\")) {\n    $(\"#btn-interrupt\").click();\n  } else {\n    jqconsole.ClearPromptText();\n  }\n});\n\n// ctrl + u to clear to beginning\njqconsole.RegisterShortcut('u', function () {\n  var text = jqconsole.GetPromptText().slice(jqconsole.GetColumn() - 4);\n  jqconsole.SetPromptText(text);\n});\n\n// ctrl + k to clear to end\njqconsole.RegisterShortcut('k', function () {\n  var text = jqconsole.GetPromptText().slice(0, jqconsole.GetColumn() - 4);\n  jqconsole.SetPromptText(text);\n});\n\n// ctrl + w to clear one word backwards\njqconsole.RegisterShortcut('w', function () {\n  var idx = jqconsole.GetColumn() - 4;\n  var text = jqconsole.GetPromptText().trim();\n  var lidx = text.slice(0, idx).lastIndexOf(\" \");\n  if (lidx == -1) {\n    lidx = 0;\n  }\n  text = text.slice(0, lidx) + \" \" + text.slice(idx + 1);\n  text = text.trim();\n  jqconsole.SetPromptText(text);\n});\n\njqconsole.RegisterShortcut('1', function () {\n  focusOnEditor();\n});\n\njqconsole.RegisterShortcut('3', function () {\n  focusOnTopRight();\n});\n\njqconsole.RegisterShortcut('4', function () {\n  focusOnBottomRight();\n});\n\n// autocomplete\njqconsole._IndentOld = jqconsole._Indent;\njqconsole._Indent = function () {\n  if (jqconsole.GetPromptText().trim() == \"\") {\n    jqconsole._IndentOld();\n  } else if (jqconsole.GetPromptText().slice(-1) == \"\\n\") {\n    jqconsole._IndentOld();\n  } else {\n    var originalPrompt = jqconsole.GetPromptText();\n    var code = jqconsole.GetPromptText();\n    code = code.slice(0, jqconsole.GetColumn() - 4);\n\n    jqconsole.ClearPromptText(true);\n\n    executeCommand(code, true, function (result) {\n      if (!result) {\n        return;\n      }\n      var predictions;\n      try {\n        predictions = JSON.parse(result.output);\n      } catch (e) {\n        console.log('[ERROR]: ' + e + ' --> ' + result.output);\n        return;\n      }\n      // if only 1 suggestion comes back then we'll take the liberty and finish\n      // the autocomplete\n      var completedText = \"\";\n      if (predictions.length == 1) {\n        var prediction = predictions[0].text;\n        originalPrompt = originalPrompt.replace(\"~\", store.get('userHome'));\n        completedText = originalPrompt.replace(code, prediction);\n        for (var i = prediction.length; i > 0; i--) {\n          var p = prediction.slice(0, i);\n          if (originalPrompt.slice(-p.length) == p) {\n            completedText = originalPrompt + prediction.slice(i);\n            break;\n          }\n        }\n        jqconsole.SetPromptText(completedText);\n        return;\n      }\n      // otherwise we need to display potential completions\n\n      // a good ratio for characters:pixels is 1:6.4. we're going to use this\n      // to make our ascii table look pretty in the space that we have\n      var widthChars = $(\"#console\").width() / 6.4;\n\n      // I tried fiding the longest string and then adding 5 characters, but\n      // just using 20 and padding 5 characters seems to be working better...\n      var longestString = 20;\n      var nCols = Math.round(widthChars / (longestString + 5), 0);\n\n      var table = new AsciiTable();\n      var row = [];\n      for (var i = 0; i < predictions.length; i++) {\n        var text;\n        // so apparenlty the predictions sometimes don't come back as { text: \"foo\"}\n        // not sure where/why this would happen but it causes mucho problemos\n        if (!predictions[i]) {\n          return;\n        }\n        text = predictions[i].text;\n        row.push(text);\n        if (row.length == nCols) {\n          table.addRow(row);\n          row = [];\n        }\n      }\n      if (row.length > 0) {\n        table.addRow(row);\n      }\n      table.removeBorder().setJustify();\n      jqconsole.Write(table.render() + '\\n\\n', 'jqconsole-output');\n      startPrompt();\n      jqconsole.SetPromptText(originalPrompt)\n    });\n  }\n};\n\n// make the cursor blink when the user is in the console\n/*\n var opacity = 0.2;\n function cursorBlink() {\n if (opacity==0.2) {\n opacity = 1;\n } else {\n opacity = 0.2\n }\n $(\".jqconsole-cursor\").css(\"opacity\", opacity);\n }\n\n var cursorBlinkId;\n $(\"#console\").focusin(function() {\n cursorBlinkId = setInterval(cursorBlink, 550);\n });\n\n $(\"#console\").focusout(function() {\n if (cursorBlinkId) {\n clearInterval(cursorBlinkId);\n cursorBlinkId = null;\n }\n });\n */\n","function sendCommand(input, hideResult) {\n  if (input) {\n    var html = templates['history-row']({ n: 1 + $(\"#history-trail\").children().length, command: input });\n    $(\"#history-trail\").append(html);\n  }\n\n  if (input==\"push it to the limit\") {\n    $(\"#time-traveler\").click();\n    return;\n  }\n\n  if (/^\\?/.test(input)) {\n    input = \"help(\" + input.slice(1) + \")\"\n  } else if (/(.+)\\?{2}$/.test(input)) {\n    input = \"help(\" + /(.+)\\?{2}$/.exec(input)[1] + \")\";\n  } else if (/(.+)\\?$/.test(input)) {\n    input = \"help(\" + /(.+)\\?$/.exec(input)[1] + \")\";\n  } else if (input==\"reset\" || input==\"%%reset\" || input==\"%reset\" || input==\"quit\" || input==\"quit()\" || input==\"exit\" || input==\"exit()\") {\n    // do quit stuff...\n    if (isDesktop()) {\n      ipc.send('quit');\n    } else {\n      bootbox.alert(\"To quit Rodeo, just exit this tab.\");\n      return;\n    }\n  }\n\n  // auto scroll down\n  $cont = $(\"#history-trail\").parent();\n  $cont[0].scrollTop = $cont[0].scrollHeight;\n\n  // actually run the command\n  var data = {\n    command: input,\n    autocomplete: false,\n    stream: true\n  };\n\n  $(\"#btn-interrupt\").removeClass(\"hide\");\n  if (isDesktop()) {\n    ipc.send('command', data);\n  } else {\n    data.msg = 'command';\n    ws.sendJSON(data);\n  }\n}\n\nfunction handleCommandResults(result) {\n  if (/^help[(]/.test(result.command)) {\n    if (result.output) {\n      $('#help-content').text(result.output);\n      $('a[href=\"#help\"]').tab(\"show\");\n      return;\n    }\n  }\n\n  if (result.status==\"input\" && result.stream) {\n    jqconsole.SetPromptText(result.stream || \"\");\n  } else if (result.status!=\"complete\" && result.stream) {\n    jqconsole.Write(result.stream || \"\");\n  }\n\n  if (result.error) {\n    track('command', 'error');\n    $(\"#btn-interrupt\").addClass(\"hide\");\n    jqconsole.Write(result.error + '\\n', 'jqconsole-error');\n  }\n\n  if (result.status==\"complete\") {\n    $(\"#btn-interrupt\").addClass(\"hide\");\n    jqconsole.Write('\\n');\n    refreshVariables();\n  }\n}\n\nif (isDesktop()) {\n  ipc.on('command', function(data) {\n    handleCommandResults(data);\n  });\n}\n\n// execute script button\n$(\"#run-button\").click(function(e) {\n  e.preventDefault();\n  var editor = getActiveEditor();\n  var code = editor.getSelectedText();\n  // if nothing was selected, then we'll run the entire file\n  if (! code) {\n    code = editor.session.getValue();\n  }\n  jqconsole.Write(\">>> \" + code + '\\n', 'jqconsole-old-input');\n  sendCommand(code);\n  return false;\n});\n\n$(\"#run-markdown\").click(function(e) {\n  track('command', 'markdown');\n  var editor = getActiveEditor();\n  var code = editor.getSelectedText();\n\n  if (! code) {\n    code = editor.session.getValue();\n  }\n\n  if (isDesktop()) {\n    var html = ipc.send('md', { doc: code });\n    var html = templates['markdown-output']({ renderedMarkdown: html, desktop: true });\n    renderMarkdown(html);\n  } else {\n    $(\"#markdown-form textarea\").val(code);\n    $(\"#markdown-form\").submit();\n  }\n});\n\nfunction executeCommand(command, autocomplete, fn) {\n  var data = {\n    \"command\": command,\n    \"autocomplete\": autocomplete,\n    stream: false\n  };\n\n  if (isDesktop()) {\n    var results = ipc.send('command', data);\n    if (fn) {\n      fn(results);\n    }\n  } else {\n    if (fn) {\n      $.get(\"command\", data, fn);\n    } else {\n      $.get(\"command\", data);\n    }\n  }\n}\n","/* globals store, ipc, templates */\n'use strict';\n\n/**\n * @param {string} dir\n * @returns {Promise}\n */\nfunction setFiles(dir) {\n  const facts = store.get('systemFacts'),\n    homedir = facts.homedir,\n    $fileList = $('#file-list'),\n    $workingDirectory = $('#working-directory'),\n    displayDotFiles = store.get('displayDotFiles');\n\n  if (!dir) {\n    throw new TypeError('Missing first parameter');\n  }\n\n  function isDotFile(file) {\n    return /\\/\\./.test(file.filename) || /^\\./.test(file.filename);\n  }\n\n  return ipc.send('files', dir).then(function (results) {\n    $fileList.children().remove();\n    $workingDirectory.children().remove();\n    $workingDirectory.append(templates['wd']({ dir: dir.replace(homedir, '~') }));\n    $fileList.append(templates['file-item']({\n      isDir: true,\n      filename: formatFilename(pathJoin([dir, '..'])),\n      basename: '..'\n    }));\n\n    let directories = results.filter(function (file) { return file.isDirectory; }),\n      files = results.filter(function (file) { return !file.isDirectory; }),\n      sortedResults = directories.concat(files);\n\n    if (displayDotFiles === false) {\n      sortedResults = sortedResults.filter(isDotFile);\n    }\n\n    return sortedResults;\n  }).then(function (results) {\n    results.forEach(function (file) {\n      $fileList.append(templates['file-item']({\n        isDir: file.isDirectory,\n        filename: file.filename,\n        basename: file.basename\n      }));\n    });\n  });\n}\n","\nfunction focusOnEditor() {\n  var id = $(\"#editors .active .editor\").attr(\"id\");\n  var editor = ace.edit(id);\n  editor.focus();\n}\n\nfunction focusOnConsole() {\n  jqconsole.Focus();\n}\n\nfunction focusOnTopRight() {\n  var next = $(\"#top-right .nav .active\").next();\n  if (! $(next).length) {\n    next = $(\"#top-right .nav li\").first();\n  }\n  $(\"a\", next).click()\n}\n\nfunction focusOnBottomRight() {\n  var next = $(\"#bottom-right .nav .active\").next();\n  if (! $(next).length) {\n    next = $(\"#bottom-right .nav li\").first();\n  }\n  $(\"a\", next).click()\n}\n","function isDesktop() {\n  return /^file:\\/\\//.test(window.location.href);\n}\n\nfunction updateRC(preferenceName, preferenceValue) {\n  if (isDesktop()) {\n    return ipc.send(\"preferences-post\", { name: preferenceName, value: preferenceValue });\n  } else {\n    $.post(\"preferences\", { name: preferenceName, value: preferenceValue });\n  }\n}\n\nfunction formatFilename(filename) {\n  // strange windows issue w/ javascript\n  if (1==2) { // path.sep==\"\\\\\") {\n    return filename.replace(/\\\\/g, '\\\\\\\\');\n  } else {\n    return filename;\n  }\n}\n\nfunction pathJoin(parts){\n  // if windows, separator = '\\\\\\\\';\n  var separator;\n  if (navigator.platform==\"Win32\") {\n    separator = '\\\\\\\\';\n  } else {\n    separator = '/';\n  }\n  var replace = new RegExp(separator+'{1,}', 'g');\n  return parts.join(separator).replace(replace, separator);\n}\n\nfunction pathBasename(path) {\n  return path.split(/[\\\\/]/).pop();\n}\n\nfunction guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n    s4() + '-' + s4() + s4() + s4();\n}\n","$(\"#package-install-button\").click(function(e) {\n  $(\"#package-install-modal\").modal('show');\n  $(\"#package-install-modal input\").focus();\n});\n\n$(\"#package-install-modal form\").submit(function(e) {\n  e.preventDefault();\n  var installer = $(\"[name='installerRadio']:checked\").val();\n  var pkgname = $(\"#package-to-install\").val();\n  var command;\n  if (installer==\"pip\") {\n    command = \"__pip_install('\" + pkgname + \"')\";\n  } else {\n    command = \"! conda install -y \" + pkgname;\n  }\n\n  jqconsole.ClearPromptText();\n  jqconsole.Write(\">>> \" + command + '\\n', 'jqconsole-old-input');\n  jqconsole.SetHistory(jqconsole.GetHistory().concat([command]));\n  sendCommand(command);\n  return false;\n});\n","// things that run last\n//\n// start the console\nstartPrompt();\nsetupPreferences();\n\ngetWorkingDirectory(function(wd) {\n  setFiles(wd);\n});\n\n(function () {\n  let pythonPaths = store.get('pythonPaths'),\n    pythonCmd = store.get('pythonCmd');\n\n  pythonPaths = pythonPaths || [];\n  if (pythonCmd && pythonPaths.indexOf(pythonCmd) < 0) {\n    pythonPaths.push(pythonCmd);\n  }\n  pythonPaths.forEach(function (pythonPath) {\n    $('#python-paths').append(templates['python-path-item'](pythonPath));\n  });\n}());\n\n// misc startup stuff...\n$('#tour').owlCarousel({ singleItem: true });\n$('[data-toggle=\"tooltip\"]').tooltip();\nsetTimeout(calibratePanes, 650);\nsetupWindows();\ninitShortcutsDisplay();\n","/**\n * todo: Somehow we need to convert this all to client-side\n */\n\n'use strict';\n\nconst shell = require('shell'),\n  remote = require('remote'),\n  BrowserWindow = require('electron').remote.BrowserWindow,\n  path = require('path'),\n  fs = require('fs'),\n  webFrame = require('web-frame'),\n  dialogs = require('dialogs')({url: '../../static/img/cowboy-hat.svg'}),\n  Menu = remote.require('menu'),\n  ipcMain = require('electron').ipcMain;\n\nfunction getMenuShortcutsTemplate() {\n  return [\n    {\n      label: 'Rodeo',\n      submenu: [\n        {\n          label: 'About Rodeo',\n          click: function () {\n            showAbout();\n          }\n        },\n        {\n          label: 'Stickers',\n          click: function () {\n            $('#sticker-modal').modal('show');\n          }\n        },\n        {\n          type: 'separator'\n        },\n        {\n          label: 'Preferences',\n          accelerator: 'CmdOrCtrl+,',\n          click: function () {\n            showPreferences();\n            track('shortcut', 'Preferences');\n          }\n        },\n        {\n          label: 'Default Variables',\n          accelerator: 'CmdOrCtrl+g',\n          click: function () {\n            showRodeoProfile();\n          }\n        },\n        {\n          type: 'separator'\n        },\n        {\n          label: 'Hide Rodeo',\n          accelerator: 'CmdOrCtrl+H',\n          selector: 'hide:'\n        },\n        {\n          label: 'Hide Others',\n          accelerator: 'CmdOrCtrl+Shift+H',\n          selector: 'hideOtherApplications:'\n        },\n        {\n          label: 'Show All',\n          selector: 'unhideAllApplications:'\n        },\n        {\n          type: 'separator'\n        },\n        {\n          label: 'Quit',\n          accelerator: 'CmdOrCtrl+Q',\n          click: function () {\n            if ($('#editorsTab .unsaved:not(.hide)').length) {\n              remote.require('dialog').showMessageBox({\n                type: 'warning',\n                buttons: ['Yes', 'Cancel'],\n                message: 'You have unsaved files in your Rodeo session. Are you sure you want to quit?',\n                detail: 'These files will be deleted permanently.'\n              }, function (reply) {\n                if (reply == 0) {\n                  // yes, nuke it\n                  ipcMain.send('quit');\n                }\n              });\n            } else {\n              ipcMain.send('quit');\n            }\n          }\n        }\n      ]\n    },\n    {\n      label: 'File',\n      submenu: [\n        {\n          label: 'New',\n          accelerator: 'CmdOrCtrl+N',\n          click: function () {\n            track('shortcut', 'New');\n            $('#add-tab').click();\n          }\n        },\n        {\n          label: 'Open',\n          accelerator: 'CmdOrCtrl+O',\n          click: function () {\n            track('shortcut', 'Open');\n            openDialog();\n          }\n        },\n        {\n          type: 'separator'\n        },\n        {\n          label: 'Save',\n          accelerator: 'CmdOrCtrl+s',\n          click: function () {\n            track('shortcut', 'Save');\n            saveEditor();\n          }\n        },\n        {\n          label: 'Save As',\n          // accelerator: 'CmdOrCtrl+C',\n          click: function () {\n            track('shortcut', 'Save As');\n            saveEditor(null, true);\n          }\n        },\n        {\n          type: 'separator'\n        },\n        {\n          label: 'Close File',\n          accelerator: 'CmdOrCtrl+w',\n          click: function () {\n            var active, n;\n\n            if (variableWindow && variableWindow.isFocused()) {\n              variableWindow.close();\n              variableWindow = null;\n            } else if (aboutWindow && aboutWindow.isFocused()) {\n              aboutWindow.close();\n              aboutWindow = null;\n            } else if (markdownWindow && markdownWindow.isFocused()) {\n              markdownWindow.close();\n              markdownWindow = null;\n            } else {\n              active = $('#editorsTab').find('.active');\n              if (active.length) {\n                n = active.attr('id').replace('editor-tab-', '');\n                closeActiveTab(n);\n              }\n            }\n            track('shortcut', 'Close File');\n          }\n        },\n        {\n          label: 'Find File',\n          accelerator: 'CmdOrCtrl+t',\n          click: function () {\n            track('shortcut', 'Find File');\n            findFile();\n          }\n        }\n      ]\n    },\n    {\n      label: 'Edit',\n      submenu: [\n        {label: 'Undo', accelerator: 'CmdOrCtrl+Z', role: 'undo'},\n        {label: 'Redo', accelerator: 'Shift+CmdOrCtrl+Z', role: 'redo'},\n        {type: 'separator'},\n        {label: 'Cut', accelerator: 'CmdOrCtrl+X', role: 'cut'},\n        {label: 'Copy', accelerator: 'CmdOrCtrl+C', role: 'copy'},\n        {label: 'Paste', accelerator: 'CmdOrCtrl+V', role: 'paste'},\n        {label: 'Select All', accelerator: 'CmdOrCtrl+A', role: 'selectAll'}\n      ]\n    },\n    {\n      label: 'View',\n      submenu: [\n        {\n          label: 'Change Editor',\n          submenu: [\n            {\n              label: 'Move One Left',\n              accelerator: 'CmdOrCtrl+Alt+Left',\n              click: function () {\n                track('shortcut', 'Change Editor > Move One Left');\n                var tab = $('#editorsTab'),\n                  prevTab = tab.find('.active').prev();\n\n                if (prevTab && $('a', prevTab).attr('href') != '#') {\n                  $('a', prevTab).click();\n                } else {\n                  $('a', tab.find('li').last().prev()).click()\n                }\n              }\n            },\n            {\n              label: 'Move One Right',\n              accelerator: 'CmdOrCtrl+Alt+Right',\n              click: function () {\n                track('shortcut', 'Change Editor > Move One Right');\n                var tab = $('#editorsTab'),\n                  nextTab = tab.find('.active').next();\n\n                if (nextTab && $('a', nextTab).attr('href') != '#') {\n                  $('a', nextTab).click();\n                } else {\n                  $('a', tab.find('li').first().next()).click();\n                }\n              }\n            }\n          ]\n        },\n        {\n          label: 'Focus',\n          submenu: [\n            {\n              label: 'Editor',\n              accelerator: 'CmdOrCtrl+1',\n              click: function () {\n                track('shortcut', 'Focus > Editor');\n                var id = $('#editors').find('.active .editor').attr('id'),\n                  editor = ace.edit(id);\n\n                editor.focus();\n              }\n            },\n            {\n              label: 'Console',\n              accelerator: 'CmdOrCtrl+2',\n              click: function () {\n                track('shortcut', 'Focus > Console');\n                jqconsole.Focus();\n              }\n            },\n            {\n              label: 'Variables/History',\n              accelerator: 'CmdOrCtrl+3',\n              click: function () {\n                track('shortcut', 'Focus > Variables/History');\n                var topRight = $('#top-right'),\n                  next = topRight.find('.nav .active').next();\n\n                if (!$(next).length) {\n                  next = topRight.find('.nav li').first();\n                }\n                $('a', next).click();\n              }\n            },\n            {\n              label: 'Files/Plots/Packages/Help',\n              accelerator: 'CmdOrCtrl+4',\n              click: function () {\n                track('shortcut', 'Focus > Files/Plots/Pacakges/Help');\n                var bottomRight = $('#bottom-right'),\n                  next = bottomRight.find('.nav .active').next();\n                \n                if (!$(next).length) {\n                  next = bottomRight.find('.nav li').first();\n                }\n                $('a', next).click();\n              }\n            }\n          ]\n        },\n        {\n          label: 'Toggle Full Screen',\n          accelerator: 'Command+Shift+F',\n          click: function () {\n            var isFull = remote.getCurrentWindow().isFullScreen();\n            \n            remote.getCurrentWindow().setFullScreen(!isFull);\n          }\n        },\n        {\n          label: 'Toggle Dev Tools',\n          accelerator: 'Alt+CmdOrCtrl+I',\n          click: function () {\n            remote.getCurrentWindow().toggleDevTools();\n          }\n        }\n      ]\n    },\n    {\n      label: 'Window',\n      submenu: [\n        {\n          label: 'Minimize',\n          accelerator: 'CmdOrCtrl+M',\n          selector: 'performMiniaturize:'\n        },\n        {\n          label: 'Reset Windows to Default Sizes',\n          click: function () {\n            remote.require('dialog').showMessageBox({\n              type: 'warning',\n              buttons: ['Yes', 'Cancel'],\n              message: 'This will restart your Rodeo session. Are you sure you want to continue?',\n              detail: 'Any unsaved scripts and data will be deleted permanently.'\n            }, function (reply) {\n              if (reply == 0) {\n                updateRC('paneVertical', null);\n                updateRC('paneHorizontalRight', null);\n                updateRC('paneHorizontalLeft', null);\n                remote.getCurrentWindow().reload();\n              }\n            });\n          }\n        },\n        {\n          label: 'Zoom',\n          submenu: [\n            {\n              label: 'Zoom to Default',\n              accelerator: 'CmdOrCtrl+0',\n              click: function () {\n                track('shortcut', 'Zoom > Default');\n                webFrame.setZoomLevel(0);\n                calibratePanes();\n              }\n            },\n            {\n              label: 'Zoom In',\n              accelerator: 'CmdOrCtrl+=',\n              click: function () {\n                track('shortcut', 'Zoom > Zoom In');\n                webFrame.setZoomLevel(webFrame.getZoomLevel() + 1);\n                calibratePanes();\n              }\n            },\n            {\n              label: 'Zoom Out',\n              accelerator: 'CmdOrCtrl+-',\n              click: function () {\n                track('shortcut', 'Zoom > Zoom Out');\n                webFrame.setZoomLevel(webFrame.getZoomLevel() - 1);\n                calibratePanes();\n              }\n            }\n          ]\n        },\n        {\n          type: 'separator'\n        },\n        {\n          label: 'Bring All to Front',\n          selector: 'arrangeInFront:'\n        }\n      ]\n    },\n    {\n      label: 'Session',\n      submenu: [\n        {\n          label: 'Restart Session',\n          accelerator: 'CmdOrCtrl+R',\n          click: function () {\n            track('shortcut', 'Session > Restart Session');\n            remote.require('dialog').showMessageBox({\n              type: 'warning',\n              buttons: ['Yes', 'Cancel'],\n              message: 'Reloading will restart your Rodeo session. Are you sure you want to continue?',\n              detail: 'Any unsaved scripts and data will be deleted permanently.'\n            }, function (reply) {\n              if (reply == 0) {\n                remote.getCurrentWindow().reload();\n              }\n            });\n          }\n        },\n        {\n          label: 'Set Working Directory',\n          accelerator: 'CmdOrCtrl+Shift+g',\n          click: function () {\n            track('shortcut', 'Session > Set Working Directory');\n            setWorkingDirectory();\n          }\n        },\n        {\n          label: 'Run Previous Command',\n          submenu: [\n            {\n              label: '2nd to Last',\n              accelerator: 'CmdOrCtrl+Shift+2',\n              click: function () {\n                track('shortcut', 'Session > Run Previous Command > 2nd to Last');\n                sendCommand($('#history-trail').children().slice(-2, -1).text());\n              }\n            },\n            {\n              label: 'Last',\n              accelerator: 'CmdOrCtrl+Shift+1',\n              click: function () {\n                track('shortcut', 'Session > Run Previous Command > Last');\n                sendCommand($('#history-trail').children().slice(-1).text());\n              }\n            }\n          ]\n        }\n      ]\n    },\n    {\n      label: 'Help',\n      submenu: [\n        {\n          label: 'Check for Updates',\n          click: function () {\n            ipcMain.send('check-for-updates');\n          }\n        },\n        {\n          label: 'View Shortcuts',\n          // no shortcut (?)\n          click: function () {\n            var modal = $('#shortcut-display-modal');\n\n            modal.modal('show');\n            modal.find('input').focus();\n          }\n        },\n        {\n          label: 'Docs',\n          click: function () {\n            shell.openExternal('http://yhat.github.io/rodeo-docs/docs/');\n          }\n        },\n        {\n          label: 'Tour',\n          click: function () {\n            var tourWindow = new BrowserWindow({\n              useContentSize: true,\n              resizable: false,\n              moveable: false,\n              center: true,\n              alwaysOnTop: true\n            });\n\n            // tourWindow.openDevTools();\n            tourWindow.on('closed', function () {\n              tourWindow = null;\n            });\n\n            // and load the index.html of the app.\n            tourWindow.loadURL('file://' + __dirname + '../../static/tour.html');\n          }\n        }\n      ]\n    }\n  ];\n}\n\n// context menu for file nav\nfunction getFileMenuTemplate() {\n  return [\n    {\n      label: 'Change Working Directory',\n      click: function () {\n        setWorkingDirectory();\n      }\n    },\n    {\n      label: 'Add Folder',\n      click: function () {\n        dialogs.prompt('Enter a name for your new folder: ', function (dirname) {\n          if (dirname) {\n            fs.mkdir(path.join(store.get('userWorkingDirectory'), dirname));\n            setFiles(store.get('userWorkingDirectory'));\n          }\n        });\n      }\n    }\n  ];\n}\n\n// context menu for file nav\nfunction getFolderMenuTemplate() {\n  return [\n    {\n      label: 'Reveal in Finder',\n      click: function () {\n        shell.showItemInFolder(folderMenu.filename);\n      }\n    },\n    {\n      label: 'Delete',\n      click: function () {\n        dialogs.confirm('Are you sure you want to delete ' + path.basename(folderMenu.filename) +\n          '? This will remove all files and directories within this folder.', function (ok) {\n\n          if (ok) {\n            shell.moveItemToTrash(folderMenu.filename);\n            setFiles(store.get('userWorkingDirectory'));\n          }\n\n        });\n      }\n    }\n  ];\n}\n\nlet menu = Menu.buildFromTemplate(getMenuShortcutsTemplate()),\n  fileMenu = Menu.buildFromTemplate(getFileMenuTemplate()),\n  folderMenu = Menu.buildFromTemplate(getFolderMenuTemplate());\n\nMenu.setApplicationMenu(menu);\n","// Plots\nfunction previousPlot() {\n  track('plot', 'previous');\n  var currentPlot = $(\"#plots .active\");\n  if ($(\"#plots .active\").prev().length) {\n    var plotid = $(\"#plots .active\").prev().data(\"plot-id\");\n    activatePlot(plotid);\n  }\n}\n\nfunction nextPlot() {\n  track('plot', 'next');\n  var currentPlot = $(\"#plots .active\")\n  if ($(\"#plots .active\").next().length) {\n    var plotid = $(\"#plots .active\").next().data(\"plot-id\");\n    activatePlot(plotid);\n  }\n}\n\nfunction deletePlot() {\n  track('plot', 'delete');\n  var currentplotid = $(\"#plots .active\").data(\"plot-id\");\n  var plotid;\n  if ($(\"#plots .active\").next().length) {\n    plotid = $(\"#plots .active\").next().data(\"plot-id\");\n    activatePlot(plotid);\n  } else if ($(\"#plots .active\").prev().length) {\n    plotid = $(\"#plots .active\").prev().data(\"plot-id\");\n    activatePlot(plotid);\n  }\n  $(\"#plots [data-plot-id='\" + currentplotid + \"']\").remove();\n  $(\"#plots-minimap [data-plot-id='\" + currentplotid + \"']\").remove();\n}\n\nfunction activatePlot(plotid) {\n  $(\"#plots .active\").removeClass(\"active\").addClass(\"hide\");\n  $(\"#plots-minimap .active\").removeClass(\"active\");\n  $(\"#plots [data-plot-id='\" + plotid + \"']\").removeClass(\"hide\").addClass(\"active\");\n  $(\"#plots-minimap [data-plot-id='\" + plotid + \"']\").addClass(\"active\");\n}\n\nfunction showPlot() {\n  track('plot', 'show');\n  if (! $(\"#plots img.active\").length) {\n    return;\n  }\n  if (isDesktop()) {\n    var BrowserWindow = remote.require('browser-window');\n    var filename = $(\"#plots img.active\").attr(\"src\");\n    var params = {toolbar: false, resizable: false, show: true, height: 1000, width: 1000};\n    var plotWindow = new BrowserWindow(params);\n    plotWindow.loadURL(filename);\n  } else {\n    var filename = $(\"#plots img.active\").attr(\"src\");\n    var newWindow = window.open(\"\",\"Rodeo Markdown\",\"width=\" + $(window).width()*0.6 +\",height=\" + $(window).height() +\",scrollbars=1,resizable=1\")\n    // read text from textbox placed in parent window\n    newWindow.document.open();\n    var img = '<img src=\"' + filename + '\" />';\n    newWindow.document.write(\"<html><body>\" + img + \"</body>\");\n    newWindow.document.close();\n  }\n}\n\nfunction savePlot() {\n  track('plot', 'save');\n  if (! $(\"#plots .active\").length) {\n    return;\n  }\n  if (isDesktop()) {\n    remote.require('dialog').showSaveDialog({\n      title: 'Export Plot',\n      default_path: ipc.send('wd-get'),\n    }, function(destfile) {\n      if (! destfile) {\n        return\n      }\n\n      if (! /\\.png$/.test(destfile)) {\n        destfile += \".png\";\n      }\n\n      if ($(\"#plots img.active\").length) {\n        // if image\n        var img = $(\"img.active\").attr(\"src\").replace(\"data:image/png;charset=utf-8;base64,\", \"\");\n        require('fs').writeFileSync(destfile, img, 'base64');\n      } else {\n        // if svg\n        var svg = document.getElementsByTagName(\"svg\")[0]\n        svgAsDataUri(svg, {}, function(uri) {\n          img = uri.replace(\"data:image/svg+xml;base64,\", \"\");\n          require('fs').writeFileSync(destfile, img, 'base64');\n        });\n      }\n    });\n  } else {\n    bootbox.alert(\"Right-click the plot to save.\");\n  }\n}\n\nfunction addPlot(result) {\n  var plotid = guid();\n  if (result.image) {\n    var plotImage = \"data:image/png;charset=utf-8;base64,\" + result.image;\n    $(\"#plots-minimap .active\").removeClass(\"active\");\n    $(\"#plots .active\").removeClass(\"active\").addClass(\"hide\");\n    var newplot = $.parseHTML('<img class=\"active\" style=\"max-height: 100%; max-width: 100%;\" />');\n    $(newplot).attr(\"src\", plotImage);\n  } else if (result.html) {\n    $(\"#plots .active\").removeClass(\"active\").addClass(\"hide\");\n    //  TODO: need to handle the sizing here\n    result.html = result.html.replace(/600px/g, \"95%\");\n    var newplot = $.parseHTML('<div class=\"active\">' + result.html + \"</div>\");\n  }\n  $(newplot).attr(\"onclick\", \"activatePlot($(this).data('plot-id'));\")\n  $(newplot).attr(\"data-plot-id\", plotid);\n  // add to plotting window and to minimap\n  $(\"#plots\").append($(newplot).clone());\n  $(\"#plots-minimap\").prepend($(newplot).clone());\n  $('a[href=\"#plot-window\"]').tab(\"show\");\n  calibratePanes();\n}\n","function setEditorTheme(theme) {\n  $(\".editor\").each(function(i, item) {\n    var editor = ace.edit(item.id);\n    editor.setTheme(theme);\n  });\n  updateRC(\"editorTheme\", theme);\n}\n\nace.require(\"ace/keyboard/vim\");\nace.require(\"ace/keyboard/emacs\");\n\nfunction setKeyBindings(binding) {\n  $(\".editor\").each(function(i, item) {\n    var editor = ace.edit(item.id);\n    if (binding==\"default\") {\n      binding = null;\n    }\n    editor.setKeyboardHandler(binding);\n  });\n  updateRC(\"keyBindings\", binding);\n}\n\nfunction setFontSize(fontSize) {\n  var fontSizeInt = parseInt(fontSize);\n  fontSize = Math.min(fontSizeInt, 22) + \"px\";\n  $(\"body\").css(\"font-size\", fontSize);\n  $(\"#console pre\").css(\"font-size\", fontSize);\n  $(\".editor\").each(function(i, item) {\n    var editor = ace.edit(item.id);\n    editor.setFontSize(fontSize);\n  });\n  updateRC(\"fontSize\", fontSizeInt);\n}\n\nfunction setFontType(fontType) {\n  $(\"body\").css(\"font-family\", fontType);\n  // $(\"#console pre\").css(\"font-family\", fontType);\n  $(\".editor\").each(function(i, item) {\n    var editor = ace.edit(item.id);\n    // TODO: not all fonts are available\n    var validFonts = [\n      \"Consolas\",\n      \"Courier New\",\n      \"Menlo\",\n      \"Monaco\"\n    ];\n    if (validFonts.indexOf(fontType) > -1) {\n      editor.setOption(\"fontFamily\", fontType);\n    }\n  });\n  updateRC(\"fontType\", fontType);\n}\n\nfunction setDefaultWd(wd) {\n  updateRC(\"defaultWd\", wd);\n}\n\nfunction setTheme(theme) {\n  if ($(\"#rodeo-theme\").attr(\"href\")!=theme) {\n    $(\"#rodeo-theme\").attr(\"href\", theme);\n  }\n  updateRC(\"theme\", theme);\n}\n\nfunction setPythonCmd(cmd) {\n  if (cmd) {\n    cmd = cmd.replace(\"~\", store.get('userHome'));\n    updateRC(\"pythonCmd\", cmd);\n  } else {\n    updateRC(\"pythonCmd\", null);\n  }\n}\n\nfunction setAutoSave(val) {\n  updateRC(\"autoSave\", val);\n}\n\nfunction setDisplayDotFiles(val) {\n  updateRC(\"displayDotFiles\", val);\n}\n\nfunction setTracking(val) {\n  updateRC(\"trackingOn\", val);\n}\n\nfunction saveWindowCalibration() {\n  var paneVertical = 100 * $(\"#pane-container #left-column\").width() / $(\"#pane-container\").width();\n  var paneHorizontalRight = 100 * $(\"#pane-container #top-right\").height() / $(\"#pane-container #right-column\").height();\n  var paneHorizontalLeft = 100 * $(\"#pane-container #top-left\").height() / $(\"#pane-container #left-column\").height();\n  updateRC(\"paneVertical\", paneVertical + \"%\");\n  updateRC(\"paneHorizontalRight\", paneHorizontalRight + \"%\");\n  updateRC(\"paneHorizontalLeft\", paneHorizontalLeft + \"%\");\n}\n\nfunction resetWindowCalibration() {\n  bootbox.dialog({\n    title: \"This will restart your Rodeo session. Are you sure you want to continue?\",\n    message: \"Any unsaved scripts and data will be deleted permanently.\",\n    buttons: {\n      cancel: {\n        label: \"Cancel\",\n        className: \"btn-default\",\n        callback: function() {\n          return;\n        }\n      },\n      yes: {\n        label: \"Yes\",\n        className: \"btn-primary\",\n          callback: function() {\n            updateRC(\"paneVertical\", null);\n            updateRC(\"paneHorizontalRight\", null);\n            updateRC(\"paneHorizontalLeft\", null);\n            window.location.reload()\n          }\n      }\n    }\n  });\n}\n\nfunction changeDefaultPath(pythonPath) {\n  if (pythonPath==\"add-path\") {\n    $('#default-python-modal').modal('show');\n  } else {\n    setPythonCmd(pythonPath);\n    bootbox.dialog({\n      title: \"Your default Python environment has been updated.\",\n      message: \"For the changes to take affect, you'll need to restart Rodeo. Would you like to do this now?\",\n      buttons: {\n        cancel: {\n          label: \"No\",\n          className: \"btn-default\",\n          callback: function() {\n            return;\n          }\n        },\n        yes: {\n          label: \"Yes\",\n          className: \"btn-primary\",\n            callback: function() {\n              require('remote').getCurrentWindow().reload();\n            }\n        }\n      }\n    });\n  }\n}\n\nfunction showRodeoProfile() {\n  // should do something special here...\n  if (isDesktop()) {\n    var userHome = ipc.send('home-get');\n    var profilePath = pathJoin([userHome, \".rodeoprofile\"]);\n    openFile(profilePath);\n  } else {\n    $.get(\"profile\", function(profile) {\n      newEditor('.rodeoprofile', '~/.rodeoprofile', profile);\n    });\n  }\n}\n\nfunction configurePreferences() {\n  let keyBindings = store.get('keyBindings'),\n    defaultWd = store.get('defaultWd'),\n    pythonPaths = store.get('pythonPaths'),\n    pythonCmd = store.get('pythonCmd'),\n    trackingOn = store.get('trackingOn'),\n    theme = store.get('theme'),\n    fontSize = store.get('fontSize'),\n    fontType = store.get('fontType');\n\n\n  // todo: to localStorage\n  keyBindings = keyBindings || 'default';\n  defaultWd = defaultWd || '';\n  fontType = fontType || 'Helvetica Neue';\n  pythonPaths = pythonPaths || [];\n  if (pythonCmd) {\n    if (pythonPaths.indexOf(pythonCmd) < 0) {\n      pythonPaths.push(pythonCmd);\n    }\n  }\n\n  if (trackingOn !== false) {\n    trackingOn = true;\n  }\n\n  var preferences_html = templates.preferences({\n      keyBindings,\n      defaultWd,\n      pythonPaths,\n      pythonCmd,\n      trackingOn,\n      fontSize,\n      fontType\n    }),\n    $preferences = $('#preferences');\n\n  $preferences.children().remove();\n  $preferences.append(preferences_html);\n  $('[data-toggle=\"tooltip\"]').tooltip();\n\n  // on startup, set defaults for non-editor preferences\n  // if (defaultWd) { // && fs.existsSync(rc.defaultWd)) {\n  //   USER_WD = defaultWd;\n  // } else {\n  //   USER_WD = store.get('userHome');\n  // }\n  if (theme) {\n    setTheme(theme);\n  }\n  if (fontSize) {\n    setFontSize(fontSize);\n  }\n  if (fontType) {\n    setFontType(fontType);\n  }\n}\n\n$(\"#add-path-button\").click(function(e) {\n  var newPath = $(\"#new-python-path\").val();\n  var data = ipc.send('test-path', newPath);\n  if (data) {\n    if (data.jupyter && data.matplotlib) {\n      var result = ipc.send('add-python-path', newPath);\n      if (result==true) {\n        $(\"#python-paths\").append(templates['python-path-item'](newPath));\n\n        bootbox.dialog({\n          title: \"Would you like this to be your default python environment?\",\n          message: \"If you do, Rodeo will restart for the changes to take affect.\",\n          buttons: {\n            cancel: {\n              label: \"No\",\n              className: \"btn-default\",\n              callback: function() {\n                setupPreferences();\n              }\n            },\n            yes: {\n              label: \"Yes\",\n              className: \"btn-primary\",\n                callback: function() {\n                  setPythonCmd(newPath);\n                  setupPreferences();\n                  require('remote').getCurrentWindow().reload();\n                }\n            }\n          }\n        });\n\n      } else {\n        $(\"#add-path-help\").text(\"Could not add python path: \" + result);\n      }\n    } else if (! data.jupyter) {\n      $(\"#add-path-help\").text(\"The path you specified did not have jupyter installed. Please install jupyter before adding a path.\");\n    }\n  } else {\n    $(\"#add-path-help\").text(\"Invalid Python. Rodeo could not run Python using the path you specified.\");\n  }\n});\n\nfunction deletePythonPath(el) {\n  var pythonPath = $(el).data(\"path\");\n  ipc.send('remove-python-path', pythonPath);\n  $(el).parent().remove();\n  setupPreferences();\n}\n\nfunction showPreferences() {\n  $('a[href^=\"#preferences\"]').click();\n}\n\nfunction setupPreferences() {\n    configurePreferences();\n}\n\nfunction registerEmail() {\n  var email = $(\"#sticker-email\").val();\n  var re = /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n  if (email && re.test(email)) {\n    window.Intercom('update', { email: email });\n    $(\"#sticker-form\").addClass(\"hide\");\n    $(\"#sticker-success\").removeClass(\"hide\");\n    $(\"#sticker-help\").text(\"\");\n    updateRC(\"email\", email);\n  } else {\n    $(\"#sticker-help\").text(\"Please input a valid email address.\");\n  }\n}\n","// basic search for history\n$('#pkg-search').on('input', function() {\n  var query = $(this).val().toLowerCase();\n  if (query==\"\") {\n    $(\"#packages-rows tr\").removeClass(\"hide\");\n  } else {\n    $(\"#packages-rows tr\").each(function(i, pkg) {\n      var packageName = $(\"td\", pkg).first().text().toLowerCase();\n      if (packageName.indexOf(query) >= 0) {\n        $(this).removeClass(\"hide\");\n      } else {\n        $(this).addClass(\"hide\");\n      }\n    });\n  }\n});\n\n// basic search for packages\n$('#history-search').on('input', function() {\n  var query = $(this).val().toLowerCase();\n  if (query==\"\") {\n    $(\"#history-trail p\").removeClass(\"hide\");\n  } else {\n    $(\"#history-trail p\").each(function(i, cmd) {\n      var cmdText = $(cmd).text().toLowerCase();\n      if (cmdText.indexOf(query) >= 0) {\n        $(this).removeClass(\"hide\");\n      } else {\n        $(this).addClass(\"hide\");\n      }\n    });\n  }\n});\n\n// basic search for packages\n$('#variable-search').on('input', function() {\n  var query = $(this).val().toLowerCase();\n  if (query==\"\") {\n    $(\"#vars tr\").removeClass(\"hide\");\n  } else {\n    $(\"#vars tr\").each(function(i, variable) {\n      var variableName = $(\"td\", variable).text().toLowerCase();\n      if (variableName.indexOf(query) >= 0) {\n        $(this).removeClass(\"hide\");\n      } else {\n        $(this).addClass(\"hide\");\n      }\n    });\n  }\n});\n","function restartSession() {\n  sendCommand(\"%reset -f\");\n  refreshVariables();\n}\n\nfunction getWorkingDirectory(fn) {\n  if (isDesktop()) {\n    var wd = ipc.send('wd-get');\n    fn(wd);\n  } else {\n    $.get(\"wd\", function(currentWd) {\n      fn(currentWd);\n    });\n  }\n}\n\nfunction pickDirectory(title, defaultPath, fn) {\n  remote.require('dialog').showOpenDialog({\n    title: title,\n    properties: ['openDirectory'],\n    defaultPath: defaultPath\n  }, function(dir) {\n    fn(dir);\n  });\n}\n\nfunction setWorkingDirectory(fn) {\n  if (isDesktop()) {\n    pickDirectory('Select a Working Directory', store.get('userWorkingDirectory'), function (wd) {\n      if (! wd) {\n        return;\n      }\n      var wd = wd[0];\n      ipc.send('wd-post', wd);\n      setFiles(wd);\n      if (fn) {\n        fn(wd);\n      }\n    });\n  } else {\n    $.get(\"wd\", function(currentWd) {\n      bootbox.prompt({\n        title: \"Please specify a working directory:\",\n        value: currentWd,\n        callback: function(wd) {\n          if (wd==null) {\n            return;\n          }\n          $.post(\"wd\", { \"wd\": wd }, function(resp) {\n            if (resp.status==\"error\") {\n              return;\n            } else {\n              $(\"#defaultWorkingDirectory\").val(wd);\n              if (fn) {\n                fn(wd);\n              }\n            }\n          });\n        }\n      });\n    });\n  }\n}\n\nfunction runLastCommand() {\n  var cmd = $(\"#history-trail\").children().slice(-1).text().trimLeft();\n  jqconsole.ClearPromptText();\n  jqconsole.Write(jqconsole.GetPromptText(true) + cmd + '\\n');\n  jqconsole.ClearPromptText();\n  sendCommand(cmd);\n}\n\nfunction run2ndToLastCommand() {\n  var cmd = $(\"#history-trail\").children().slice(-2, -1).text().trimLeft();\n  jqconsole.ClearPromptText();\n  jqconsole.Write(jqconsole.GetPromptText(true) + cmd + '\\n');\n  jqconsole.ClearPromptText();\n  sendCommand(cmd);\n}\n\nfunction logout() {\n  window.location.href = \"/logout\";\n}\n","// Tab stuff\n$(\"#add-tab\").click(function(e) {\n  e.preventDefault();\n  addEditor();\n  return false;\n});\n\nfunction track(cat, action, label, value) {\n  const userId = store.get('userId'),\n    version = store.get('version');\n\n  var data = {\n    an: 'Rodeo',          // app name\n    av: version,       // app version\n    cid: userId,           // user id\n    ec: cat,              // event category\n    ea: action,           // event action\n    el: label             // event label\n  };\n\n  var url = 'http://rodeo-analytics.yhathq.com/?' + serialize(data);\n\n  if (navigator.onLine === true) {\n    var request = new XMLHttpRequest();\n\n    request.open('GET', url, true);\n    request.onload = function () {\n      if (request.status >= 200 && request.status < 400) {\n        // good to go\n        // console.log(\"metric tracked!\");\n      } else {\n        console.error('error with metrics');\n      }\n    };\n    request.send();\n  }\n}\n\n// things that need a place\n\nfunction serialize(obj) {\n  var str = [];\n  for(var p in obj)\n    if (obj.hasOwnProperty(p)) {\n      str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\n    }\n  return str.join(\"&\");\n}\n\n\n// tell server if we're online or offline\nvar updateOnlineStatus = function () {\n  console.log(navigator.onLine ? 'online' : 'offline');\n};\n// send subsequent changes to status\nwindow.addEventListener('online',  updateOnlineStatus);\nwindow.addEventListener('offline',  updateOnlineStatus);\n","$(\"#file-upload-trigger\").change(function () {\n  var input = document.getElementById('file-upload-trigger');\n  var file = input.files[0];\n  var fr = new FileReader();\n  fr.onload = (function(theFile) {\n    return function(e) {\n      var filename = theFile.name.replace(\"C:\\\\fakepath\\\\\", '');\n      newEditor(filename, filename, e.target.result);\n    };\n  })(file);\n  fr.readAsText(file);\n});\n","function fileIndexStart() {\n  $(\"#file-search-list .list\").children().remove();\n  $(\"#file-search-list .list\").append(\"<li id='index-count'><i class='fa fa-hourglass-end'></i>&nbsp;Indexing files</li>\");\n}\n\nfunction indexFile(data) {\n  var fileSearchItem = templates['file-search-item'](data);\n  $(\"#file-search-list .list\").append(fileSearchItem);\n}\n\nfunction fileIndexUpdate(data) {\n  var html = \"<i class='fa fa-hourglass-end'></i>&nbsp;Indexing files \" + data.nComplete;\n  $(\"#file-search-list .list #index-count\").html(html);\n}\n\nfunction fileIndexInterrupt() {\n  $(\"#file-search-list .list\").children().remove();\n  var msg = \"Sorry this directory was too big to index.\"\n  $(\"#file-search-list .list\").append(\"<li id='index-count'><i class='fa fa-ban'></i>&nbsp;\" + msg + \"</li>\");\n}\n\nfunction fileIndexComplete() {\n  // remove the 'indexing...' and make the files visible\n  $(\"#file-search-list #index-count\").remove();\n  $(\"#file-search-list .list .hide\").removeClass(\"hide\");\n  // update the UI\n  indexFiles();\n}\n\nvar fileList;\nfunction indexFiles() {\n  $(\"#file-search-list .list li\").removeClass(\"selected\");\n  $(\"#file-search-list .list li\").first().addClass(\"selected\");\n  var options = { valueNames: [ 'filename' ] };\n  fileList = new List('file-search-list', options);\n  $(\"#file-search-form\").unbind();\n  $(\"#file-search-form\").submit(function(e) {\n    e.preventDefault();\n    var filename = $(\"#file-search-list .selected\").attr(\"data-filename\");\n    openFile(filename);\n    $(\"#file-search-input\").val(\"\");\n    $(\"#file-search-modal\").modal(\"hide\");\n    $(\"#file-search-list .list li\").removeClass(\"selected\");\n    return false;\n  });\n}\n\nfunction refreshVariables() {\n  executeCommand(\"__get_variables(globals())\", false, function(result) {\n    if (! result.output) {\n      $(\"#vars\").children().remove();\n      console.error(\"[ERROR]: Result from code execution was null.\");\n      return;\n    }\n    var variables = JSON.parse(result.output);\n    $(\"#vars\").children().remove();\n    var variableTypes = [\"list\", \"dict\", \"ndarray\", \"DataFrame\", \"Series\", \"function\", \"other\"];\n    variableTypes.forEach(function(type) {\n      var isOnDesktop = isDesktop();\n      variables[type].forEach(function(v) {\n        $(\"#vars\").append(templates['active-variable']({\n            name: v.name, type: type, repr: v.repr, isDesktop: isOnDesktop\n          })\n        );\n      }.bind(this));\n    });\n    // configure column widths\n    $(\"#vars tr\").first().children().each(function(i, el) {\n      $($(\"#vars-header th\")[i]).css(\"width\", $(el).css(\"width\"));\n    });\n  });\n}\n\nfunction refreshPackages() {\n  executeCommand(\"__get_packages()\", false, function(result) {\n    var packages = JSON.parse(result.output);\n    $(\"#packages-rows\").children().remove();\n    packages.forEach(function(p) {\n      $(\"#packages-rows\").append(\n        templates['package-row']({ name: p.name, version: p.version})\n      );\n    });\n  });\n}\n\nfunction findFile() {\n  $(\"#file-search-modal\").unbind();\n  $(\"#file-search-modal\").modal(\"show\");\n  $(\"#file-search-modal input\").focus();\n  $(\"#file-search-modal\").keydown(function(e){\n    var selectedFile = $(\"#file-search-list .list .selected\").data(\"filename\");\n    if (! fileList) {\n      return;\n    }\n    var nextFile;\n    if (e.which==40) {\n      // down\n      for(var i=0; i<fileList.matchingItems.length-1; i++) {\n        if ($(fileList.matchingItems[i].elm).data(\"filename\")==selectedFile) {\n          nextFile = $(fileList.matchingItems[i+1].elm).data(\"filename\");\n          break;\n        }\n      }\n      if (! nextFile) {\n        nextFile = $(fileList.matchingItems[0].elm).data(\"filename\");\n      }\n    } else if (e.which==38) {\n      // up\n      for(var i=fileList.matchingItems.length-1; i>0; i--) {\n        if ($(fileList.matchingItems[i].elm).data(\"filename\")==selectedFile) {\n          nextFile = $(fileList.matchingItems[i-1].elm).data(\"filename\");\n          break;\n        }\n      }\n      if (! nextFile) {\n        nextFile = $(fileList.matchingItems[fileList.matchingItems.length-1].elm).data(\"filename\");\n      }\n    }\n\n    $(\"#file-search-list .list li\").each(function(i, el) {\n      if ($(el).data(\"filename\")==nextFile) {\n        $(\"#file-search-list .list .selected\").removeClass(\"selected\");\n        $(el).addClass(\"selected\");\n        // keep selected item in the center\n        var $parentDiv = $(\"#file-search-list ul\");\n        var $innerListItem = $(el);\n        $parentDiv.scrollTop($parentDiv.scrollTop() + $innerListItem.position().top - $parentDiv.height()/1.5 + $innerListItem.height()/3);\n      }\n    });\n  });\n}\n\n\nfunction setDefaultPreferences(editor) {\n  const keyBindings = store.get('keyBindings'),\n    editorTheme = store.get('editorTheme'),\n    fontSize = store.get('fontSize'),\n    autoSave = store.get('autoSave');\n\n  editor.setKeyboardHandler(keyBindings === 'default' ? null : keyBindings); // null is the \"default\"\n  editor.setTheme(editorTheme || 'ace/theme/chrome');\n  editor.setFontSize(fontSize || 12);\n\n  if (autoSave) {\n    editor.on('input', function () {\n      saveEditor();\n    });\n  }\n}\n\nfunction saveActiveEditor(saveas) {\n  saveas = saveas || false\n  var editor = getActiveEditor();\n  saveEditor(editor, saveas);\n}\n\nfunction closeActiveFile() {\n  if ($(\"#editorsTab .active\").length) {\n    var n = $(\"#editorsTab .active\").attr(\"id\").replace(\"editor-tab-\", \"\");\n    closeActiveTab(n);\n  }\n}\n\nfunction shiftEditorLeft() {\n  var prevTab = $(\"#editorsTab .active\").prev();\n  if (prevTab && $(\"a\", prevTab).attr(\"href\")!=\"#\") {\n    $(\"a\", prevTab).click();\n  } else {\n    prevTab = $(\"#editorsTab li\").last().prev();\n    $(\"a\", prevTab).click()\n  }\n  var id = $(prevTab).attr(\"id\").replace(\"tab-\", \"\");\n  ace.edit(id).focus();\n}\n\nfunction shiftEditorRight() {\n  var nextTab = $(\"#editorsTab .active\").next();\n  if (nextTab && $(\"a\", nextTab).attr(\"href\")!=\"#\") {\n    $(\"a\", nextTab).click();\n  } else {\n    nextTab = $(\"#editorsTab li\").first().next();\n    $(\"a\", nextTab).click();\n  }\n  var id = $(nextTab).attr(\"id\").replace(\"tab-\", \"\");\n  ace.edit(id).focus();\n}\n\nfunction getActiveEditor() {\n  var id = $(\"#editors .active .editor\").attr(\"id\");\n  return ace.edit(id);\n}\n\nfunction saveFile(filepath, content, fn) {\n  var payload = { \"filepath\": filepath, \"content\": content };\n  if (isDesktop()) {\n    var data = ipc.send('file-post', payload);\n    fn(data);\n  } else {\n    $.post('file', payload, function(resp) {\n      fn(resp);\n    });\n  }\n}\n\n\nfunction closeActiveTab(n) {\n  if (! $(\"#editor-tab-\" + n + \" .unsaved\").hasClass(\"hide\")) {\n    bootbox.dialog({\n      title: \"Do you want to save the changes you've made to this file?\",\n      message: \"Your changes will be discarded otherwise.\",\n      buttons: {\n        cancel: {\n          label: \"Cancel\",\n          className: \"btn-default\",\n          callback: function() {\n            return;\n          }\n        },\n        dontSave: {\n          label: \"Don't Save\",\n          className: \"btn-default\",\n            callback: function() {\n              $(\"#editorsTab .editor-tab-a\").first().click();\n              $(\"#editor-tab-\" + n).remove();\n              $(\"#editor-tab-pane-\" + n).remove();\n            }\n        },\n        save: {\n          label: \"Save\",\n          className: \"btn-primary\",\n          callback: function() {\n            saveEditor(ace.edit(\"editor-\" + n), null, function() {\n              $(\"#editorsTab .editor-tab-a\").first().click();\n              $(\"#editor-tab-\" + n).remove();\n              $(\"#editor-tab-pane-\" + n).remove();\n            });\n          }\n        }\n      }\n    });\n  } else {\n    var prevTab = $(\"#editor-tab-\" + n).prev();\n    $(\"#editor-tab-\" + n).remove();\n    $(\"#editor-tab-pane-\" + n).remove();\n    if (prevTab && $(\"a\", prevTab).attr(\"href\")!=\"#\") {\n      $(\"a\", prevTab).click();\n    }\n  }\n}\n\nfunction newEditor(basename, fullpath, content) {\n  var editor = addEditor();\n  $(\"#editorsTab li:nth-last-child(2) .name\").text(basename);\n  $(\"#editorsTab li:nth-last-child(2) a\").attr(\"data-filename\", fullpath);\n  editor.getSession().setValue(content);\n  return editor;\n}\n\nfunction openFile(pathname, isDir) {\n  // if file is already open, then just switch to it\n  if ($(\"#editorsTab a[data-filename='\" + pathname + \"']\").length) {\n    $(\"#editorsTab a[data-filename='\" + pathname + \"']\").click();\n    return;\n  } else if (isDir) {\n    var directory = pathname;\n    setFiles(pathname);\n  } else {\n    function callback(basename, pathname, content) {\n      var editor = newEditor(basename, pathname, content)\n      // [+] tab is always the last tab, so we'll activate the 2nd to last tab\n      $(\"#editorsTab li:nth-last-child(2) a\").click();\n      var id = $(\"#editors .editor\").last().attr(\"id\");\n      // set to not modified -- NOT IDEAL but it works :)\n      setTimeout(function() {\n        $(\"#\" + id.replace(\"editor\", \"editor-tab\") + \" .unsaved\").addClass(\"hide\");\n      }, 50);\n    }\n    if (isDesktop()) {\n      var data = ipc.send('file-get', pathname);\n      callback(data.basename, pathname, data.content);\n    } else {\n      $.get(\"file\", { filepath: pathname }, function(resp) {\n        callback(resp.basename, pathname, resp.content);\n      });\n    }\n  }\n}\n\nfunction saveEditor(editor, saveas, fn) {\n  saveas = saveas || false;\n  var id = $($(\"#editorsTab .active a\").attr(\"href\") + \" .editor\").attr(\"id\");\n  if (! editor) {\n    editor = ace.edit(id);\n  }\n\n  var filename = $(\"#editorsTab .active a\").text();\n  var content = editor.getSession().getValue();\n  if (! $(\"#editorsTab .active a\").attr(\"data-filename\") || saveas==true) {\n    if (isDesktop()) {\n      remote.require('dialog').showSaveDialog({\n        title: 'Save File',\n        default_path: ipc.send('wd-get'),\n      }, function(destfile) {\n        if (! destfile) {\n          return\n        }\n        // if there's no file extension specified, we'll assume they meant a python file\n        if (! /\\.[A-Za-z0-9]{1,5}$/.test(destfile)) {\n          destfile = destfile + \".py\";\n        }\n        var basename = pathBasename(destfile);\n        $(\"#editorsTab .active a .name\").text(basename);\n        $(\"#editorsTab .active a\").attr(\"data-filename\", destfile);\n        saveFile(destfile, content, function(resp) {\n          $(\"#\" + id.replace(\"editor\", \"editor-tab\") + \" .unsaved\").addClass(\"hide\");\n          setFiles();\n          if (fn) {\n            fn();\n          }\n        });\n      });\n    } else {\n      bootbox.prompt(\"Please specify a name for your file:\", function(destfile) {\n        if (destfile==null) {\n          return;\n        }\n        var basename = pathBasename(destfile);\n        $(\"#editorsTab .active a .name\").text(basename);\n        $(\"#editorsTab .active a\").attr(\"data-filename\", destfile);\n        saveFile(destfile, content, function(resp) {\n          $(\"#\" + id.replace(\"editor\", \"editor-tab\") + \" .unsaved\").addClass(\"hide\");\n          setFiles();\n          if (fn) {\n            fn();\n          }\n        });\n      });\n    }\n  } else {\n    saveFile($(\"#editorsTab .active a\").attr(\"data-filename\"), content, function(resp) {\n      $(\"#\" + id.replace(\"editor\", \"editor-tab\") + \" .unsaved\").addClass(\"hide\");\n      setFiles();\n      if (fn) {\n        fn();\n      }\n    });\n  }\n}\n\nfunction openDialog() {\n  require('remote').dialog.showOpenDialog({\n    title: \"Select a file to open\",\n    defaultPath: require(\"electron\").ipcRenderer.send(\"wd-get\"),\n    properties: [\"openFile\"]\n  }, function(filenames) {\n    if (filenames && filenames.length > 0) {\n      openFile(filenames[0]);\n    }\n  });\n}\n","function addEditor() {\n  var id;\n  if ($(\"#editors .editor\").length) {\n    id = parseInt($(\"#editors .editor\").last().attr(\"id\").split(\"-\")[1]) + 1;\n  } else {\n    id = 1;\n  }\n\n  var editor_tab_html = templates['editor-tab']({ n: id, name: \"Untitled-\" + id + \".py\", isFirst: id==0});\n  var editor_html = templates.editor({ n: id });\n\n  $(editor_tab_html).insertBefore($(\"#add-tab\").parent());\n  $(\"#editors\").append(editor_html);\n  // set to the active tab\n  $(\"#editor-tab-\" + id + \" .editor-tab-a\").click();\n  var editor = ace.edit(\"editor-\" + id);\n  editor = configureEditor(editor);\n  editor.focus();\n  return editor;\n}\n","function getCurrentLine(editor) {\n  return editor.session.getLine(editor.getCursorPosition().row);\n}\n\nfunction configureEditor(editor) {\n\n  track('application', 'editor');\n\n  var langTools = ace.require(\"ace/ext/language_tools\");\n  // this removes local completer\n  langTools.setCompleters([]);\n\n  var Autocomplete = ace.require(\"ace/autocomplete\").Autocomplete;\n  editor.completer = new Autocomplete(editor);\n  editor.setTheme(\"ace/theme/chrome\");\n  editor.getSession().setMode(\"ace/mode/python\");\n  editor.setOptions({\n    useSoftTabs: true,\n    showPrintMargin: false,\n    enableBasicAutocompletion: true,\n    enableSnippets: false,\n    enableLiveAutocompletion: false\n  });\n  editor.$blockScrolling = Infinity;\n\n  // Autocomplete\n  var pythonCompleter = {\n    getCompletions: function(editor, session, pos, prefix, fn) {\n      session.$mode.$keywordList = [];\n      // get the current line from the begining of the line to the cursor\n      var code = getCurrentLine(editor).slice(0, editor.getCursorPosition().column);\n\n      executeCommand(code, true, function(result) {\n        console.log(result);\n        result.output = JSON.parse(result.output);\n        var predictions = result.output.map(function(p) {\n          var value = p.text;\n          // if it's not a filename and there's a \".\" in the value, we want\n          // to set the value to just the last item in the list\n          if (value.indexOf(\"/\")==-1 && value.indexOf(\".\") > -1) {\n            value = value.split(\".\").slice(value.split(\".\").length-1).join(\".\");\n          }\n\n          return {\n            caption: p.text,\n            value: value,\n            score: 100,\n            meta: null,\n            docHTML: \"<code>\" + p.text + \"</code>\" + \"<br/>\" + \"<br/>\" + \"<pre style='margin: 0; padding: 0;'>\" + p.docstring + \"</pre>\" || \"<p>\" + p.text + \"</p>\"\n            // docHTML: \"<code>\" + p.text + \"</code>\" + \"<br/>\" + \"<br/>\" + \"<pre style='margin: 0; padding: 0;'>\" + p.docstring + \"</pre>\" || \"<p>\" + p.text + \"</p>\"\n          };\n        });\n\n        fn(null, predictions);\n      });\n    }\n  };\n  langTools.addCompleter(pythonCompleter);\n\n\n  // start shortcuts\n\n  // TODO: fix this...\n  var allCommands = editor.commands.byName;\n  editor.commands.bindKey(\"Cmd-d\", null);\n  allCommands.findnext.bindKey = {win: \"Ctrl-d\", mac: \"Cmd-d\"};\n  editor.commands.addCommand(allCommands.findnext)\n\n\n  editor.commands.addCommand({\n    name: \"shift-editor-left\",\n    bindKey: {win: \"ctrl-option-left\", mac: \"ctrl-option-left\"},\n    exec: function(editor) {\n      track('shortcut', 'Change Editor > Move One Left');\n      shiftEditorLeft();\n    }\n  });\n\n  editor.commands.addCommand({\n    name: \"shift-editor-right\",\n    bindKey: {win: \"ctrl-option-right\", mac: \"ctrl-option-right\"},\n    exec: function(editor) {\n      track('shortcut', 'Change Editor > Move One Right');\n      shiftEditorRight();\n    }\n  });\n\n  // override the settings menu\n  editor.commands.addCommand({\n    name: \"showPreferences\",\n    bindKey: {win: \"ctrl-,\", mac: \"Command-,\"},\n    exec: function(editor) {\n      track('shortcut', 'Preferences');\n      showPreferences();\n    }\n  });\n\n  // override cmd+shift+g\n  editor.commands.addCommand({\n    name: \"pickWorkingDirectory\",\n    bindKey: {win: \"ctrl-Shift-g\", mac: \"Command-Shift-g\"},\n    exec: function(editor) {\n      track('shortcut', 'Change Working Directory');\n      setWorkingDirectory();\n    }\n  });\n\n  // override cmt+t\n  editor.commands.addCommand({\n    name: \"findFile\",\n    bindKey: {win: \"ctrl-option-t\", mac: \"Command-option-t\"},\n    exec: function(editor) {\n      track('shortcut', 'Find File');\n      findFile();\n    }\n  });\n\n  editor.commands.addCommand({\n    name: \"findFile2\",\n    bindKey: {win: \"ctrl-k\", mac: \"Command-k\"},\n    exec: function(editor) {\n      findFile();\n    }\n  });\n\n  // indent selection\n  editor.commands.addCommand({\n    name: \"indentSelection\",\n    bindKey: {win: \"ctrl-\\]\", mac: \"Command-\\]\"},\n    exec: function(editor) {\n      if (editor.getSelectedText()) {\n        editor.blockIndent(editor.getSelectionRange());\n      } else {\n        editor.blockIndent(editor.getCursorPosition().row);\n      }\n    }\n  });\n\n  // outdent selection\n  editor.commands.addCommand({\n    name: \"outSelection\",\n    bindKey: {win: \"ctrl-\\[\", mac: \"Command-\\[\"},\n    exec: function(editor) {\n      if (editor.getSelectedText()) {\n        editor.blockOutdent(editor.getSelectionRange());\n      } else {\n        editor.blockOutdent(editor.getCursorPosition().row);\n      }\n    }\n  });\n\n  editor.commands.addCommand({\n    name: \"sendCommand\",\n    bindKey: {win: \"ctrl-Enter\", mac: \"Command-Enter\"},\n    exec: function(editor) {\n      track('command', 'python');\n      // grab selected text\n      var text = editor.getCopyText();\n\n      // get the current line number and the next line number\n      var currentRow = editor.getSelectionRange().end.row;\n      var nextRow = currentRow + 1;\n\n      // if they don't have anything highlighted (i.e. going 1 line at a time), then\n      //  we need to be a little tricky\n      if (text==\"\") {\n        text = editor.session.getLine(currentRow);\n      }\n      text = jqconsole.GetPromptText() + text;\n\n      var isFinished = false;\n      if (nextRow==editor.session.getLength()) {\n        // we're done. send the code\n        isFinished = true;\n      } else if (editor.session.getLine(nextRow)==\"\") {\n        // we're done. send the code\n        isFinished = true;\n      } else if (/return/.test(editor.session.getLine(currentRow))) {\n        // we're done. send the code\n        isFinished = true;\n      } else if (! /^ /.test(editor.session.getLine(nextRow))) {\n        isFinished = true;\n      } else {\n        // well then we're still going...\n      }\n\n      if (isFinished) {\n        jqconsole.SetPromptText(text);\n        jqconsole.Write(jqconsole.GetPromptText(true) + '\\n');\n        jqconsole.ClearPromptText();\n        jqconsole.SetHistory(jqconsole.GetHistory().concat([text]));\n        sendCommand(text);\n        // this seems to behave better without the scroll getting in th way...\n        // editor.scrollToLine(currentRow + 1, true, true, function () {});\n      } else {\n        text = text + '\\n';\n        jqconsole.ClearPromptText();\n        jqconsole.SetPromptText(text);\n      }\n      if (nextRow==editor.session.getLength()) {\n        editor.session.setValue(editor.session.getValue() + \"\\n\")\n      }\n      editor.gotoLine(currentRow + 2, 10, true);\n    }\n  });\n\n  editor.commands.addCommand({\n    name: \"saveFile\",\n    bindKey: {win: \"ctrl-s\", mac: \"Command-s\"},\n    exec: function(editor) {\n      saveEditor(editor);\n    }\n  });\n\n  editor.commands.addCommand({\n    name: \"cancelInput\",\n    bindKey: {win: \"ctrl-shift-c\", mac: \"ctrl-c\"},\n    exec: function(editor) {\n      jqconsole.SetPromptText('');\n    }\n  });\n\n  editor.commands.addCommand({\n    name: \"autocomplete\",\n    bindKey: {win: \"Tab\", mac: \"Tab\"},\n    exec: function(editor) {\n      var pos = editor.getCursorPosition();\n      var text = editor.session.getTextRange({\n        start: { row: pos.row, column: pos.column - 1 },\n        end: { row: pos.row, column: pos.column }\n      });\n\n      var line = getCurrentLine(editor);\n\n      // Don't ask about the setTimeout-50 business. This bug came out of nowhere.\n      // Everything was working fine without it and then all of a sudden it popped\n      // up. I'm not even sure how I thought that this might fix it. It was a\n      // total shot in the dark. Million to one shot doc, million to one.\n      if (/from /.test(line) || /import /.test(line)) {\n        setTimeout(function() {\n          editor.completer.showPopup(editor);\n        }, 50);\n      } else if (text!=\" \" && text!=\"\") {\n        setTimeout(function() {\n          editor.completer.showPopup(editor);\n        }, 50);\n      } else {\n        editor.insert(\"    \");\n      }\n    }\n  });\n  // generic shortcuts\n  // Focus\n  editor.commands.addCommand({\n    name: \"focus-2\",\n    bindKey: {win: \"ctrl-2\", mac: \"Command-2\"},\n    exec: function(editor) {\n      focusOnConsole();\n    }\n  });\n  editor.commands.addCommand({\n    name: \"focus-3\",\n    bindKey: {win: \"ctrl-3\", mac: \"Command-3\"},\n    exec: function(editor) {\n      focusOnTopRight();\n    }\n  });\n  editor.commands.addCommand({\n    name: \"focus-4\",\n    bindKey: {win: \"ctrl-4\", mac: \"Command-4\"},\n    exec: function(editor) {\n      focusOnBottomRight();\n    }\n  });\n  // Run previous\n  editor.commands.addCommand({\n    name: \"runLastCommand\",\n    bindKey: {win: \"ctrl-shift-1\", mac: \"Command-shift-1\"},\n    exec: function(editor) {\n      runLastCommand();\n    }\n  });\n  editor.commands.addCommand({\n    name: \"run2ndToLastCommand\",\n    bindKey: {win: \"ctrl-shift-2\", mac: \"Command-shift-2\"},\n    exec: function(editor) {\n      run2ndToLastCommand();\n    }\n  });\n  // new file\n  editor.commands.addCommand({\n    name: \"newFile\",\n    bindKey: {win: \"ctrl-option-shift-n\", mac: \"ctrl-option-shift-n\"},\n    exec: function(editor) {\n      $(\"#add-tab\").click();\n    }\n  });\n\n  if (! isDesktop()) {\n    editor.commands.addCommand({\n      name: \"openUserFile\",\n      bindKey: {win: \"ctrl-o\", mac: \"command-o\"},\n      exec: function(editor) {\n        $('#file-upload-trigger').click();\n      }\n    });\n    editor.commands.addCommand({\n      name: \"closeOpenFile\",\n      bindKey: {win: \"ctrl-option-shift-w\", mac: \"command-option-shift-w\"},\n      exec: function(editor) {\n        var n = $(\"#editorsTab .active\").attr(\"id\").replace(\"editor-tab-\", \"\");\n        closeActiveTab(n);\n        getActiveEditor().focus();\n      }\n    });\n    editor.commands.addCommand({\n      name: \"closeOpenFile2\",\n      bindKey: {win: \"ctrl-b\", mac: \"command-b\"},\n      exec: function(editor) {\n        var n = $(\"#editorsTab .active\").attr(\"id\").replace(\"editor-tab-\", \"\");\n        closeActiveTab(n);\n        getActiveEditor().focus();\n      }\n    });\n  }\n\n  // end shortcuts\n\n  editor.on('input', function() {\n    $(\"#\" + editor.container.id.replace(\"editor\", \"editor-tab\") + \" .unsaved\").removeClass(\"hide\");\n  });\n\n  setDefaultPreferences(editor);\n  return editor;\n}\n","'use strict';\n\nvar ipc = require('electron').ipcRenderer;\n\nipc.on('refresh-variables', function () {\n  refreshVariables();\n});\n\nipc.on('refresh-packages', function () {\n  refreshPackages();\n});\n\nipc.on('setup-preferences', function () {\n  setupPreferences();\n});\n\nipc.on('plot', function (result) {\n  addPlot(result);\n  $('#btn-interrupt').addClass('hide');\n});\n\nipc.on('set-working-directory', function (wd) {\n  setFiles(wd);\n});\n\nipc.on('file-index-start', function () {\n  fileIndexStart();\n});\n\nipc.on('index-file', function (data) {\n  indexFile(data);\n});\n\nipc.on('file-index-update', function (data) {\n  fileIndexUpdate(data);\n});\n\nipc.on('file-index-interrupt', function () {\n  fileIndexInterrupt();\n});\n\nipc.on('file-index-complete', function () {\n  fileIndexComplete();\n});\n\nipc.on('open-file', function (filepath) {\n  openFile(filepath);\n});\n\nipc.on('log', function (data) {\n  console.log('[LOG]: ' + data.toString());\n});\n\nipc.on('ready', function () {\n  $('#loading-modal').modal('hide');\n});\n\nipc.on('no-update', function () {\n  var body = \"Good news! You're running the most up to date version of Rodeo.\";\n  new Notification(\"You're up to date\", {\n    title: \"You're up to date\", body: body\n  });\n});\n\nipc.on('update-ready', function (data) {\n  var body, n;\n\n  if (data.platform === 'windows') {\n    body = 'Click here to download the latest version.';\n  } else {\n    body = 'Click here to update';\n  }\n  n = new Notification('Update Available', { title: 'Update Available', body: body });\n  n.onclick = function () {\n    if (data.platform === 'windows')  {\n      require('shell').openExternal('https://www.yhat.com/products/rodeo/downloads');\n    } else {\n      ipc.send('update-and-restart');\n    }\n  };\n});\n\nipc.on('startup-error', function (err) {\n  showError(err);\n});\n\nipc.on('start-tour', function () {\n  $('#tour-modal').modal('show');\n});\n\nipc.on('prompt-for-sticker', function () {\n  $('#sticker-modal').modal('show');\n});\n\nipc.on('activated', function () {\n  \n});\n\nipc.send('index-files');\n","// setup the shortcut display modal here. we're using a handlebars\n// template here are a partial (the shortcuts table is really big).\n// this keeps this file a lot cleaner.\n\nfunction initShortcutsDisplay() {\n  $(\"#shortcut-display-modal #shortcuts\").append(templates.shortcuts());\n\n  $(\"#shortcut-search\").on('input', function() {\n    var query = $(this).val().toLowerCase();\n    if (query==\"\") {\n      $(\"#shortcuts tr .hide\").removeClass(\"hide\");\n    } else {\n      $(\"#shortcut-rows tr\").each(function(i, shortcut) {\n        var text = [];\n        $(\"td\", shortcut).map(function(i, el) {\n          text.push($(el).text());\n        });\n        text = text.join(\"-\").toLowerCase();\n        if (text.indexOf(query) > -1) {\n          $(this).removeClass(\"hide\");\n        } else {\n          $(this).addClass(\"hide\");\n        }\n      });\n    }\n  });\n}\n","var aboutWindow;\n\nfunction showAbout() {\n  var params = {toolbar: false, resizable: false, show: true, height: 500, width: 400 };\n  var BrowserWindow = remote.require('browser-window');\n  aboutWindow = new BrowserWindow(params);\n  aboutWindow.loadURL('file://' + __dirname + '/../static/about.html');\n  // aboutWindow.openDevTools();\n}\n","var variableWindow;\nfunction showVariable(varname, type) {\n  var params = { toolbar: false, resizable: true, show: true, height: 800, width: 1000 };\n\n  var BrowserWindow = remote.require('browser-window');\n  variableWindow = new BrowserWindow(params);\n  variableWindow.loadURL('file://' + __dirname + '/../static/display-variable.html');\n  // variableWindow.openDevTools();\n\n  var show_var_statements = {\n    DataFrame: \"print(\" + varname + \"[:1000].to_html())\",\n    Series: \"print(\" + varname + \"[:1000].to_frame().to_html())\",\n    list: \"pp.pprint(\" + varname + \")\",\n    ndarray: \"pp.pprint(\" + varname + \")\",\n    dict: \"pp.pprint(\" + varname + \")\",\n    \"function\": \"print(inspect.getsource(\" + varname + \"))\",\n    other: \"pp.pprint(\" + varname + \")\"\n  }\n\n  variableWindow.webContents.on('dom-ready', function() {\n    var showVar = show_var_statements[type];\n    if (! showVar) {\n      showVar = show_var_statements.other;\n    }\n    executeCommand(showVar, false, function(result) {\n      variableWindow.webContents.send('ping', { type: type, html: result.output });\n    });\n  });\n\n  variableWindow.on('close', function() {\n    variableWindow = null;\n  });\n}\n","var markdownWindow;\nfunction renderMarkdown(html) {\n  var params = { toolbar: false, resizable: true, show: true, height: 800, width: 1000 };\n\n  var BrowserWindow = remote.require('browser-window');\n  markdownWindow = new BrowserWindow(params);\n\n  // I'm not proud of this, but we need the file to be in the same relative directory\n  // as our css, js, etc.\n  markdownWindow.loadURL('file://' + __dirname + '/../static/markdown-desktop.html');\n  markdownWindow.webContents.on('dom-ready', function() {\n    markdownWindow.webContents.send('content', { html: html });\n  });\n\n  ipc.on('pdf', function(destfile) {\n    if (! /\\.pdf$/.test(destfile)) {\n      destfile = destfile + \".pdf\";\n    }\n    markdownWindow.webContents.printToPDF({}, function(err, data) {\n      require('fs').writeFile(destfile, data, function(error) {\n        if (err) {\n          throw error;\n        }\n      });\n    });\n  });\n  // markdownWindow.openDevTools();\n}\n","function setupWindows() {\n  // resizeable panes\n  $(\"#pane-container\").height($(window).height() - $(\".navbar\").height());\n\n  const paneVertical = store.get('paneVertical') || '50%',\n    paneHorizontalRight = store.get('paneHorizontalRight') || '50%',\n    paneHorizontalLeft = store.get('paneHorizontalLeft') || '50%',\n    paneContainer = $('#pane-container');\n\n  paneContainer.height($(window).height() - $(\".navbar\").height());\n\n  paneContainer.split({\n    orientation: 'vertical',\n    limit: 100,\n    position: paneVertical\n  });\n\n  $('#right-column').split({\n    orientation: 'horizontal',\n    limit: 100,\n    position: paneHorizontalRight\n  });\n\n  $('#left-column').split({\n    orientation: 'horizontal',\n    limit: 100,\n    position: paneHorizontalLeft\n  });\n}\n\nfunction saveWindowCalibration() {\n  var paneVertical = 100 * $(\"#pane-container #left-column\").width() / $(\"#pane-container\").width();\n  var paneHorizontalRight = 100 * $(\"#pane-container #top-right\").height() / $(\"#pane-container #right-column\").height();\n  var paneHorizontalLeft = 100 * $(\"#pane-container #top-left\").height() / $(\"#pane-container #left-column\").height();\n  updateRC(\"paneVertical\", paneVertical + \"%\");\n  updateRC(\"paneHorizontalRight\", paneHorizontalRight + \"%\");\n  updateRC(\"paneHorizontalLeft\", paneHorizontalLeft + \"%\");\n}\n\nfunction calibratePanes() {\n\n  $(\"#pane-container\").height($(window).height() - ($(\".navbar\").height() || 0));\n  // Top Left\n  var topLeftHeight = $(\"#top-left\").height();\n  var offset = $(\"#top-left #editorsTab\").height() + 2;\n  $(\"#top-left #editors\").height(topLeftHeight - offset);\n\n  // Bottom Left\n  var bottomLeftHeight = $(\"#bottom-left\").height();\n  var offset = $(\"#bottom-left #consoleTab\").height() + 1;\n  $(\"#consoleTabContainer\").height(bottomLeftHeight - offset);\n  // TODO: this is getting called constantly\n  // setConsoleWidth($(\"#console\").width());\n\n  // Top Right\n  var offset = $(\"#top-right ul\").height() + 1;\n  $(\"#environment\").height($(\"#top-right\").height() - offset);\n  $(\"#history\").height($(\"#top-right\").height() - offset);\n  // $(\"#vars\").height($(\"#top-right\").height()*.7);\n  $(\"#vars-container\").height($(\"#environment\").height() - offset);\n\n  // Bottom Right\n  var tabOffset = $(\"#bottom-right .nav-tabs\").height() + 1;\n  $(\"#bottomRightTabContent\").height($(\"#bottom-right\").height() - tabOffset);\n  // files\n  $(\"#file-list\").height($(\"#bottomRightTabContent\").height() - $(\"#working-directory\").height());\n  // packages\n  $(\"#packages\").height($(\"#bottom-right\").height() - tabOffset);\n  var offset = 42 + 30 + 1; // $(\"#packages table\").first().height() + $(\"#packages .row\").first().height() + 1;\n  $(\"#packages-container\").height($(\"#packages\").height() - offset);\n\n  // plots\n  $(\"#plot-window\").height($(\"#bottom-right\").height() - tabOffset);\n  var offset = offset + 25 + 5; //13;\n  $(\"#plots img\").css(\"max-height\", $(\"#bottom-right\").height() - offset);\n  $(\"#plots-minimap\").css(\"max-height\", $(\"#bottom-right\").height() - offset);\n  // help\n  $(\"#help-content\").parent().height($(\"#bottom-right\").height() - tabOffset);\n  $(\"#help-content\").height($(\"#bottom-right\").height() - tabOffset);\n  // preferences\n  $(\"#preferences\").height($(\"#bottom-right\").height() - tabOffset);\n  // $(\"#preferences .panel-body\").height($(\"#bottom-right\").height() - tabOffset);\n  $(\"#preferences\").parent().height($(\"#bottom-right\").height() - tabOffset);\n  $(\"#preferences\").height($(\"#bottom-right\").height() - tabOffset);\n\n  // scrolling fixes...\n  // removes stupid scroll bars on windows/linux\n  $(\"[style*=height]\").css(\"overflow\", \"hidden\");\n\n  // things we actually want to scroll\n  // top right\n  $(\"#vars-container\").css(\"overflow-y\", \"scroll\");\n  $(\"#history\").css(\"overflow-y\", \"scroll\");\n  // bottom right\n  $(\"#file-list\").css(\"overflow-y\", \"scroll\");\n  $(\"#plots-minimap\").css(\"overflow-y\", \"scroll\");\n  $(\"#packages-container\").css(\"overflow-y\", \"scroll\");\n  $(\"#help-content\").css(\"overflow-y\", \"scroll\");\n  $(\"#preferences\").css(\"overflow-y\", \"scroll\");\n\n  // resize the editors so nothing gets cut off\n  $(\"#editors .editor\").each(function(i, el) {\n    var id = $(el).attr(\"id\");\n    ace.edit(id).resize();\n  })\n}\n\n// on resize w/ gray bars, recalibrate\n$(document.documentElement).bind('mouseup.splitter touchend.splitter touchleave.splitter touchcancel.spliter', function(e) {\n  saveWindowCalibration();\n  calibratePanes();\n});\n\nwindow.onresize = function(evt) {\n  calibratePanes();\n};\n","function showError(err) {\nreturn;\n\n\n\n  var params = { toolbar: false, resizable: false, show: true, height: 800, width: 800, alwaysOnTop: true };\n  var BrowserWindow = remote.require('browser-window');\n  errorWindow = new BrowserWindow(params);\n  errorWindow.loadURL('file://' + __dirname + '/../static/setup-error.html');\n  errorWindow.openDevTools();\n  errorWindow.webContents.on('did-finish-load', function() {\n    errorWindow.webContents.send('startup-error', err);\n  });\n\n  return;\n\n  $(\"#loading-modal\").modal('hide');\n  // $(\"#error-modal .possible-error\").addClass(\"hide\");\n\n  console.log(\"[ERROR]: \", err);\n\n  if (/python path/.test(err)) {\n    $(\"#good-to-go\").addClass(\"hide\");\n    $(\"#install-jupyter\").addClass(\"hide\");\n    $(\"#python-path-missing\").removeClass(\"hide\");\n\n    $(\"#output-python\").removeClass(\"hide\")\n                        .removeClass(\"list-group-item-success\")\n                        .addClass(\"list-group-item-danger\");\n    $(\"#output-python i\").removeClass(\"fa-check\").addClass(\"fa-times\");\n\n    $(\"#output-jupyter\").removeClass(\"hide\")\n                        .removeClass(\"list-group-item-success\")\n                        .addClass(\"list-group-item-danger\");\n    $(\"#output-jupyter i\").removeClass(\"fa-check\").addClass(\"fa-times\");\n  } else if (/jupyter/.test(err)) {\n    $(\"#good-to-go\").addClass(\"hide\");\n    $(\"#install-jupyter\").removeClass(\"hide\");\n    $(\"#python-path-missing\").addClass(\"hide\");\n\n    $(\"#output-python\").removeClass(\"hide\")\n                        .removeClass(\"list-group-item-danger\")\n                        .addClass(\"list-group-item-success\");\n    $(\"#output-python i\").removeClass(\"fa-times\").addClass(\"fa-check\");\n\n    $(\"#output-jupyter\").removeClass(\"hide\")\n                        .removeClass(\"list-group-item-success\")\n                        .addClass(\"list-group-item-danger\");\n    $(\"#output-jupyter i\").removeClass(\"fa-check\").addClass(\"fa-times\");\n  } else {\n    $(\"#good-to-go\").removeClass(\"hide\");\n    $(\"#install-jupyter\").addClass(\"hide\");\n    $(\"#python-path-missing\").addClass(\"hide\");\n\n    $(\"#output-python\").removeClass(\"hide\")\n                        .removeClass(\"list-group-item-danger\")\n                        .addClass(\"list-group-item-success\");\n    $(\"#output-python i\").removeClass(\"fa-times\").addClass(\"fa-check\");\n\n    $(\"#output-jupyter\").removeClass(\"hide\")\n                        .removeClass(\"list-group-item-danger\")\n                        .addClass(\"list-group-item-success\");\n    $(\"#output-jupyter i\").removeClass(\"fa-times\").addClass(\"fa-check\");\n    // setTimeout(function() {\n    //   $(\"#error-modal\").modal('hide');\n    // }, 1500);\n  }\n\n  $(\"#error-modal\").modal({ backdrop: 'static', keyboard: false, show: true });\n  if (/win32/i.test(navigator.platform)) {\n    $(\"#which-python pre\").text('c:\\\\> for %i in (python.exe) do @echo. %~$PATH:i');\n    $(\"#error-modal a\").attr(\"onClick\", \"shell.openItem('cmd.exe');\")\n  }\n}\n\nfunction pickPython() {\n  require('remote').dialog.showOpenDialog({\n    title: \"Select your Python\",\n    properties: [ 'openFile' ]\n  }, function(pythonPath) {\n    $(\"#python-path\").val(pythonPath);\n  });\n}\n\nfunction testPath(path) {\n  $(\"#error-modal .possible-error\").addClass(\"hide\");\n  var data = ipc.send('test-path', path);\n\n  // dramatically unveil the results\n  $(\"#output-jupyter\").css(\"opacity\", 0);\n  $(\"#output-python\").css(\"opacity\", 0).animate({ opacity: 1, duration: 250 });\n  setTimeout(function() {\n    $(\"#output-jupyter\").animate({ opacity: 1 });\n  }, 750);\n\n  setTimeout(function() {\n    if (data.result.status && data.result) {\n      if (data.result.jupyter) {\n        ipc.send('launch-kernel', path);\n        $(\"#rodeo-ready\").removeClass(\"hide\");\n        $(\"#test-results\").children().remove();\n        setTimeout(function() {\n          $(\"#error-modal\").modal('hide');\n        }, 3000);\n      } else if (data.result.jupyter==false) {\n        $(\"#install-jupyter\").removeClass(\"hide\");\n      }\n    }\n  }, 1250+400);\n}\n\n$(\"#btn-set-path\").click(function(e) {\n  var newPath = $(\"#python-path\").val();\n  if (newPath) {\n    testPath(newPath);\n  }\n});\n"],"sourceRoot":"/source/"}